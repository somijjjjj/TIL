# 힙(heap)

힙은 그래프의 트리 구조 중 하나로 '우선순위 큐(queue)'를 구현할 때 사용된다.  
우선순위 큐는 데이터 구조의 하나로서 데이터를 자유롭게 추가할 수 있다.  
반면, 데이터를 추출할 때는 최솟값부터 순서대로 선택된다.  
추가는 자유롭게 하고 추출할 때는 작은 값부터 꺼내느 것이 우선순위큐이다.  
또한 힙을 표현하는 트리 구조에서는 각 정점을 '노드(node)'라고 부른다.  
힙에서는 각 노드에 데이터가 저장된다.  

[사진출처](https://namu.wiki/w/%ED%9E%99%20%ED%8A%B8%EB%A6%AC)

![](https://velog.velcdn.com/images/silver0/post/4d68f475-df89-4564-a922-6c7709e98d2b/image.png)

힙의 각 노드에 데이터가 저장되어 있고, 최대 두 개의 자식 노드를 가진다.  
트리의 모양은 데이터의 개수에 의해 정해진다.  
노드는 위에서부터 채워지며, 같은 층(단)에서는 왼쪽부터 채워진다.  

힙에서는 데이터 저장 위치를 정하기 위해 자식 노드의 숫자는 반드시 부모의 숫자보다 커야 한다는 규칙이 있다.   
따라서 가장 위(뿌리)에 가장 작은 숫자가 들어있다.    
데이터를 추가할 때는 이 규칙을 지키기 위해 가장 아래층에 있는 왼쪽 노드부터 값을 채운다.  
가장 아래 층이 모두 채워지면 새로운 층을 만들어서 가장 왼쪽에 채운다.   

### 데이터 추가

![](https://velog.velcdn.com/images/silver0/post/5d06db23-74ba-4cb5-b9fb-06409f1863c7/image.png)


가장 아래층 남아있는 자리에 데이터가 추가된다.  
부모의 숫자가 클 때는 조건을 만족하지 않으므로 부모와 자식을 교환한다.  
규칙에 맞으면 그대로 두며, 이런 처리를 교환이 발생하지 않을 때까지 반복한다.  

### 데이터 삭제

![](https://velog.velcdn.com/images/silver0/post/c776ca4d-55e5-4551-a184-c55c72252cb5/image.png)

힙에서 숫자를 꺼낼 때는 가장 위에 있는 루트 노드가 추출된다.    
힙에서 가장 위에 있는 숫자가 최솟값을 지니고 있기 때문이다.    
힙의 구조를 다시 정리해야 하는데, 가장 후미에 있는 숫자를 가장 위로 이동한다.  
부모 숫자보다 자식 숫자가 작은 경우는 자식의 좌우에 있는 숫자 중 더 작은 쪽과 교환한다.  
이 처리를 교환이 발생하지 않을 때까지 반복한다.  

### 계산시간

힙은 항상 가장 위에 최솟값이 있으므로 데이터 수에 상관없이 O(1) 시간에 최솟값을 추출할 수 있다.  
추출한 후 힙을 재구축할 때에는 가장 후미에 있는 데이터를 가장 위로 가져온 후 자식과 비교해가며 아래 방향으로 진행한다.  
이 때문에 계산시간은 트리의 높이와 비례하게 된다.  
힙 형성 조건에 따라 트리의 높이는 log $_2$ n 이므로 재구축의 계싼 시간은 O(log n)이 된다.  
데이터추가도 마찬가지로 O(log n)이 된다.  

### 활용 예

관리하고 있는 데이터 중에서 최솟값을 자주 추출해야 하는 경우에는 힙이 편리하다.  
예를 들어, 다익스트라 알고리즘에서는 후보가 되는 노드 중에서 최솟값을 매 단계에서 선택하는데, 
이때 노드를 관리하기 위해 힙을 사용하는 경우도 있다.  

---

<br>
<br>

> Reference
> - 『알고리즘 도감』, 이시다 모리테루, 미야자키 쇼이치 - 제이펍